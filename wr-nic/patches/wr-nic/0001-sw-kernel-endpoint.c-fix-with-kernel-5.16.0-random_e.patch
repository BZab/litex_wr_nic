From db59ca0b03e29ec55b3bd8ac0c85c72b05c0495b Mon Sep 17 00:00:00 2001
From: Gwenhael Goavec-Merou <gwenhael@enjoy-digital.fr>
Date: Mon, 8 Apr 2024 11:03:40 +0200
Subject: [PATCH 1/3] sw/kernel/endpoint.c: fix with kernel >= 5.16.0
 (random_ether_addr -> eth_random_addr

Signed-off-by: Gwenhael Goavec-Merou <gwenhael@enjoy-digital.fr>
---
 sw/kernel/endpoint.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/sw/kernel/endpoint.c b/sw/kernel/endpoint.c
index b07f87c..354bccb 100644
--- a/sw/kernel/endpoint.c
+++ b/sw/kernel/endpoint.c
@@ -296,7 +296,11 @@ int wrn_endpoint_probe(struct net_device *dev)
 		if (is_zero_ether_addr(wraddr)) {
 			pr_warn("wr_nic: missing MAC address, randomize\n");
 			/* randomize a MAC address, so lazy users can avoid ifconfig */
+#if LINUX_VERSION_CODE < KERNEL_VERSION(5,16,0)
 			random_ether_addr(wraddr);
+#else
+			eth_random_addr(wraddr);
+#endif
 			/* Clear the MSB on fourth octect to prevent bit overflow on OUI */
 			wraddr[3] &= 0x7F;
 		}
-- 
2.43.2

